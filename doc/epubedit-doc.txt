*epubedit-doc.txt*      For Neovim >= 0.9.4      Last change: 2025 November 09

==============================================================================
Table of Contents                             *epubedit-doc-table-of-contents*

1. epubedit.nvim                                  |epubedit-doc-epubedit.nvim|
  - Requirements                                   |epubedit-doc-requirements|
  - Installation                                   |epubedit-doc-installation|
  - Usage                                                 |epubedit-doc-usage|
  - Configuration                                 |epubedit-doc-configuration|
  - Development                                     |epubedit-doc-development|

==============================================================================
1. epubedit.nvim                                  *epubedit-doc-epubedit.nvim*

Edit EPUB archives directly from Neovim. `epubedit.nvim` unpacks an EPUB into a
temporary workspace and repacks the archive when you are done.


REQUIREMENTS                                       *epubedit-doc-requirements*

- Neovim 0.8.0 or newer
- System `zip` and `unzip` binaries available on `$PATH` (configurable)
- Optional: `nvim-neo-tree/neo-tree.nvim` <https://github.com/nvim-neo-tree/neo-tree.nvim> to browse the OPF via a dedicated source


INSTALLATION                                       *epubedit-doc-installation*

Install with your preferred plugin manager. Example using lazy.nvim
<https://github.com/folke/lazy.nvim>:

>lua
    {
      "helmecke/epubedit.nvim",
      config = function()
        require("epubedit").setup()
      end,
    }
<


USAGE                                                     *epubedit-doc-usage*

1. Run `:EpubEditOpen path/to/book.epub` (or omit the path to be prompted). The plugin unpacks the archive into a managed workspace on disk and switches Neovim’s current working directory to that location.
2. Edit any buffer inside the workspace using normal Neovim navigation—`:edit`, Telescope, fuzzy finders, etc. Saving a buffer writes back to the unpacked copy.
3. Run `:EpubEditSave` to repack the archive in place, or `:EpubEditSave path/to/output.epub` to create a new copy.

If unsaved buffers exist, `:EpubEditSave` refuses to proceed and lists the
files to write. Workspaces are cleaned up automatically after saving unless
`preserve_workspace = true`, and the working directory is restored when the
session ends.


NEO-TREE SOURCE ~

If you navigate with neo-tree.nvim
<https://github.com/nvim-neo-tree/neo-tree.nvim>, add the `epubedit` source to
its configuration:

>lua
    require("neo-tree").setup({
      sources = { "filesystem", "buffers", "git_status", "epubedit" },
      default_source = "filesystem",
      epubedit = {
        window = { position = "right" }, -- pick any location you prefer
      },
    })
<

After `:EpubEditOpen`, the plugin automatically opens and focuses Neo-tree’s
`epubedit` source (as long as neo-tree is installed and the source is
registered in your `sources` list) so you can see the OPF spine followed by
manifest resources grouped by media type. You can still trigger `:Neotree
source=epubedit` manually if you close it. The pane refreshes automatically
after `:EpubEditOpen`, `:EpubEditSave`, or when the workspace is cleaned up,
and it closes again after `:EpubEditSave`/cleanup so you are not left with a
stale tree. When no session is active, the source displays a helpful
placeholder instead of throwing errors. Renaming or moving files inside the
`epubedit` source updates the manifest `href` inside the OPF and immediately
refreshes the tree so the new location is reflected everywhere. File nodes
mimic Sigil’s book browser by showing OPF-relative paths (e.g.,
`OEBPS/Text/Section0001.xhtml`), making it easy to correlate entries with the
underlying archive, and the move dialog only asks for the portion after the OPF
root (e.g., everything after `OEBPS/`) so the root directory itself stays
intact. Grouping mirrors Sigil’s "Text / Styles / Images / Fonts / Audio /
Video / Misc" structure, and you can rename/reorder those sections via
`neo_tree.group_labels` and `neo_tree.group_order`.

Tip: launching Neovim with an EPUB file (`nvim book.epub`) automatically hands
the buffer off to `:EpubEditOpen`, so you can jump straight into the unpacked
workspace without running the command manually.


COMMANDS ~

- `:EpubEditOpen [path]` – Unpack an EPUB into a workspace.
- `:EpubEditSave [path]` – Repack the active workspace. Optional `path` writes to a different location; otherwise the original file is replaced (with confirmation by default).
- `:EpubEditClose` – Abandon the current workspace without saving, clean up the temp directory, and restore the previous working directory.


HEALTH CHECK ~

Run `:checkhealth epubedit` to verify the `zip`/`unzip` dependencies and
workspace configuration.


CONFIGURATION                                     *epubedit-doc-configuration*

>lua
    require("epubedit").setup({
      zip_bin = "zip",          -- custom path to `zip`
      unzip_bin = "unzip",      -- custom path to `unzip`
      workspace_root = nil,     -- optional directory for unpacked workspaces
      preserve_workspace = false, -- keep workspaces after saving
      prompt_overwrite = true,  -- confirm before overwriting the source EPUB
      neo_tree = {
        group_order = { "text", "styles", "images", "fonts", "audio", "video", "misc" },
        group_labels = {
          text = "Text",
          styles = "Styles",
          images = "Images",
          fonts = "Fonts",
          audio = "Audio",
          video = "Video",
          misc = "Misc",
        },
      },
    })
<

`workspace_root` defaults to the OS temp directory. When set, the plugin
creates uniquely named sub-directories inside the provided path. The `neo_tree`
section lets you override the Sigil-style grouping order/labels used inside the
neo-tree source.


DEVELOPMENT                                         *epubedit-doc-development*

- Run the test suite with `make test` (requires Neovim plus `zip`/`unzip`).
- Format Lua code with `stylua lua plugin`.
- Regenerate help docs with `make docs` (CI handles this automatically via `panvimdoc`).

Generated by panvimdoc <https://github.com/kdheepak/panvimdoc>

vim:tw=78:ts=8:noet:ft=help:norl:
